<!DOCTYPE html>
<html>
   <head>

      <script type="module" src="scripts/vanilla-tagger.webc.js" defer></script>

      <script>

         let tagger;

          /*-----------------------------------------------------------------------------------------*/         

          document.addEventListener("DOMContentLoaded", function() {
            setup();
          });        

          /*-----------------------------------------------------------------------------------------*/          

          let setup = function setup() {          
            tagger = document.getElementById("v-tagger");
            
            bindEvents();
          };

          /*-----------------------------------------------------------------------------------------*/          

          let bindEvents = function bindEvents() {          
            tagger.addEventListener('VanillaTagger:componentCreated',function (e) { 
               console.log("Component created: " + e.target.id);
             });

             tagger.addEventListener('VanillaTagger:themeLoaded',function (e) { 
               console.log("Style theme loaded from: " + e.detail);
             });

             tagger.addEventListener('VanillaTagger:formatTriggered',function (e) { 
               let format = e.detail,
                   state = (format.state ? "activated" : "deactivated") ,
                   breakpoint = format.breakpoint;
                   
               console.log("Format " + format.format + " has been " + state + " at the " + breakpoint + "px width");
             });


             tagger.addEventListener('VanillaTagger:imgLoaded',function (e) { 
               console.log("Image loaded: " + JSON.stringify(e.detail));
             });

             tagger.addEventListener('VanillaTagger:tagAdded',function (e) { 
               console.log("Tag added: " + JSON.stringify(e.detail));
             });

             tagger.addEventListener('VanillaTagger:tagsLoaded',function (e) { 
               console.log("Tags loaded: " + JSON.stringify(e.detail));
             });

             tagger.addEventListener('VanillaTagger:tagsReset',function (e) { 
               console.log("Tags reset!");
             });

             tagger.addEventListener('VanillaTagger:popupClosedByClick',function (e) { 
               console.log("Popup closed by click for tag: " + JSON.stringify(e.detail));
             });
             
             tagger.addEventListener('VanillaTagger:tagClick',function (e) { 
               console.log("Tag clicked: " + JSON.stringify(e.detail));
             });

             tagger.addEventListener('VanillaTagger:tagMouseover',function (e) { 
               console.log("Tag mouse over: " + JSON.stringify(e.detail));

               const tag = e.detail;
               
               if (tag.id == "greenTag") { 
                   tag.addClass("pulsating");
               }    
             });

             tagger.addEventListener('VanillaTagger:tagMouseout',function (e) { 
               console.log("Tag mouse out: " + JSON.stringify(e.detail));

               const tag = e.detail;
               
               if (tag.id == "greenTag") { 
                   tag.removeClass("pulsating");
               }    
             });

          };

          /*-----------------------------------------------------------------------------------------*/

          var redTagHelper = function redTagHelper(tag) { 
                  let choice =  (tag.hasClass("shape-marker-full") ? "a marker icon" : "a marker shape"),
                      message = "The " + tag.id + " has functions attached to the click event via the \"onclick\" trigger in the tag definition.\n\n" ,
                      question = "E.g.: Would you like a " + choice + " for this tag?",
                      action = (tag.hasClass("shape-marker-full") ? "icon" : "shape"),
                      decision = confirm(message + question);

                      if (decision && action==="shape") {
                          tag.removeClass("icon-marker");
                          tag.removeClass("show-index-ontop");
                          tag.addClass("shape-marker-full");
                          tag.addClass("show-index");
                      }    
                      else if (decision && action==="icon") {
                          tag.removeClass("shape-marker-full");
                          tag.removeClass("show-index");
                          tag.addClass("icon-marker");
                          tag.addClass("show-index-ontop");
                      }    
          };

          /*-----------------------------------------------------------------------------------------*/

          let toggleAllPopups = function toggleAllPopups() {
            tagger.toggleAllPopups();
          };

          /*-----------------------------------------------------------------------------------------*/          

      </script>
  
   </head>
   <body>

      <h1>See source & console for tags configuration & events, resize window for responsiveness</h1>

      <vanilla-tagger 
         id="v-tagger"
         data-img='https://images.unsplash.com/photo-1493134799591-2c9eed26201a?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&w=1000&q=80'
         data-tags='[{
                        "top": 20,
                        "left": 20,
                        "classes": "light with-border pulsating-onhover show-index-ontop icon-camera responsive",
                        "link": {"href":"https://www.linkedin.com/in/giuseppepizzimenti/", "target":"_blank"},
                        "popup" :  {
                          "classes": "dark",
                          "arrow": "center",
                          "position": "right",
                          "content": "This tag is responsive, has visible index, an icon ,<br/> a link and is pulsating on hover"           
                        }
                     },{
                        "id" : "redTag",
                        "top": 36.5693,
                        "left": 52.5,
                        "classes": "red pulsating",
                        "onclick" : "redTagHelper",
                        "popup" : "Click me!"           
                     },{
                        "id" : "greenTag",
                        "top": 44.7584,
                        "left": 29.625,
                        "classes": "green responsive show-index",
                        "popup" : {
                          "classes": "light closeable",
                          "arrow": "center",
                          "position": "right",
                          "showOn": "toggle",
                          "content": "<b>Info on this tag</b><p>This tag is responsive, has no icon , a visible index <br/>and functions attached to the mouseover/mouseout</br> events via event listeners.<br/><br/><i>Also, you can click it to toggle this popup!</i>"
                        }
                     },{
                        "top": 12.3792,
                        "left": 68.375,
                        "classes": "blue small pulsating",
                        "popup" :  {
                          "classes" : "blue",
                          "arrow": "right",
                          "position": "bottom",
                          "content":"This tag is small and pulsating ...and it&apos;s blue like this bottom-positioned, right-aligned popup!"             
                        }
                     },{
                        "top": 80,
                        "left": 20,
                        "classes": "dark with-border with-shadow show-index",
                        "popup" : {
                          "classes": "light",
                          "arrow": "center",
                          "position": "top",
                          "showOn": "hover",
                          "content": "<b><i>Look! A dolphin!</i></b><br/><br/><img width=\"100\" height=\"90\" src=\"https://images.unsplash.com/photo-1570481662006-a3a1374699e8?auto=format&fit=crop&w=100&height=90&q=80\"/>"
                        }   
                     },{
                        "top": 17.2,
                        "left": 4.9,
                        "height": 36.5,
                        "width": 6.7,
                        "classes": "xlight with-shadow show-index pulsating-onhover"
                     },{
                      "top": 25.6036,
                      "left": 84.8,
                      "height": 34.8733,
                      "width": 6.6,
                      "classes": "xlight with-shadow with-border show-index",
                      "popup" :  {
                        "classes": "xdark",
                        "arrow": "top",
                        "position": "left",
                        "content": "A<br/>very,<br/>very,<br/>very,<br/>very,<br/>very,<br/>tall<br/>skyscraper<br/>(but, at last<br/>this popup<br/>is aligned<br/>on top)"
                       }
                      },{
                        "top": 50.1937,
                        "left": 28.6,
                        "height": 10.5812,
                        "width": 30.4,
                        "classes": "xlight with-shadow with-border show-caption pulsating-onhover responsive",
                        "caption": "A complex of condos",
                        "popup" :  {
                          "classes": "xdark",
                          "arrow": "center",
                          "position": "bottom",
                          "content": "This tag has a caption"
                         }
                   }]'
      >
            Your browser doesn't currently support this component<br>
            <a href="https://browsehappy.com/" target="_blank">Please , update your browser</a>
      </vanilla-tagger>

      <br/>
      <br/>

      <button onclick="toggleAllPopups()"><b>Toggle all popups</b></button>


   </body>
</html